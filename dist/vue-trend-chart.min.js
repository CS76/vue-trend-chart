!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self)["vue-trend-chart"]=e()}(this,function(){"use strict";function e(t){var e=t.split(" ").filter(function(t){return""!==t}).map(function(t){return parseInt(t)});return!(e.length<1||4<e.length)&&e.every(function(t){return"number"==typeof t&&0<=t})}function t(t){var e=t.split(" ").filter(function(t){return""!==t}).map(function(t){return parseInt(t)});switch(e.length){case 4:return{top:e[0],right:e[1],bottom:e[2],left:e[3]};case 3:return{top:e[0],right:e[1],bottom:e[2],left:e[1]};case 2:return{top:e[0],right:e[1],bottom:e[0],left:e[1]};default:return{top:e[0],right:e[0],bottom:e[0],left:e[0]}}}var i={name:"TrendChartGrid",props:{xAxes:{default:!1,type:Boolean},xAxesLines:{type:Number},yAxes:{default:!1,type:Boolean},yAxesLines:{type:Number},padding:{default:"0",type:String,validator:function(t){return e(t)}}},computed:{xLines:function(){return this.xAxesLines||this.$parent.params.maxAmount},boundary:function(){return this.$parent.boundary},gridPaddingObject:function(){return this.$parent.gridPaddingObject}},methods:{setXLineParams:function(t){var e=this,n=e.boundary,i=e.xLines,a=e.gridPaddingObject,s=(n.maxX-n.minX)/(i-1),r=n.minX+s*(t-1);return{x1:r,x2:r,y1:n.minY-a.top,y2:n.maxY+a.bottom,stroke:"rgba(0,0,0,0.1)"}},setYLineParams:function(t){var e=this,n=e.boundary,i=e.yAxesLines,a=e.gridPaddingObject,s=(n.maxY-n.minY)/(i-1),r=n.minY+s*(t-1);return{x1:n.minX-a.left,x2:n.maxX+a.right,y1:r,y2:r,stroke:"rgba(0,0,0,0.1)"}}},render:function(t){if(this.xAxes&&this.yAxes){var e=[];if(this.xAxes&&0<this.xLines){for(var n=[],i=1;i<=this.xLines;i++)n.push(t("line",{class:"trend-chart-grid-x-axis",attrs:Object.assign({},this.setXLineParams(i))}));e.push(t("g",{class:"trend-chart-grid-x"},n))}if(this.yAxes&&0<this.yAxesLines){for(var a=[],s=1;s<=this.yAxesLines;s++)a.push(t("line",{class:"trend-chart-grid-y-axis",attrs:Object.assign({},this.setYLineParams(s))}));e.push(t("g",{class:"trend-chart-grid-y"},a))}return t("g",e)}}},a={name:"TrendChartLabels",props:{xLabels:{type:Array},xLabelsPosition:{default:"bottom",type:String,validator:function(t){return-1!==["top","bottom"].indexOf(t)}},xLabelsOffset:{default:5,type:Number},yLabelsAmount:{type:Number},yLabelsPosition:{default:"left",type:String,validator:function(t){return-1!==["left","right"].indexOf(t)}},yLabelsOffset:{default:5,type:Number},yLabelsTextFormatter:{default:function(t){return t},type:Function}},computed:{boundary:function(){return this.$parent.boundary},gridPaddingObject:function(){return this.$parent.gridPaddingObject}},methods:{setXLabelsParams:function(t){var e=this,n=e.boundary,i=e.gridPaddingObject,a=e.xLabels,s=e.xLabelsPosition,r=e.xLabelsOffset,o=(n.maxX-n.minX)/(a.length-1);return{x:n.minX+o*t,y:"bottom"==s?n.maxY+i.bottom+r:n.minY-i.top-r}},setYLabelsParams:function(t){var e=this,n=e.boundary,i=e.gridPaddingObject,a=e.yLabelsAmount,s=e.yLabelsPosition,r=e.yLabelsOffset,o=(n.maxY-n.minY)/(a-1);return{x:"left"==s?n.minX-i.left-r:n.maxX+i.right+r,y:n.maxY-o*t}}},render:function(n){var i=this;if(this.xLabels&&this.xLabels.length&&this.yLabelsAmount&&0<this.yLabelsAmount){var t=[];if(this.xLabels&&this.xLabels.length&&t.push(n("g",{class:"trend-chart-labels-x"},this.xLabels.map(function(t,e){return n("text",{class:"trend-chart-label-x",attrs:Object.assign({},i.setXLabelsParams(e),{"text-anchor":"middle","dominant-baseline":"bottom"==i.xLabelsPosition?"text-before-edge":"text-after-edge"})},t)}))),this.yLabelsAmount&&0<this.yLabelsAmount){for(var e=[],a=0;a<this.yLabelsAmount;a++)e.push(n("text",{class:"trend-chart-label-y",attrs:Object.assign({},this.setYLabelsParams(a),{"text-anchor":"left"==this.yLabelsPosition?"end":"start","dominant-baseline":"middle"})},this.yLabelsTextFormatter(this.$parent.params.minValue+(this.$parent.params.maxValue-this.$parent.params.minValue)/(this.yLabelsAmount-1)*a)));t.push(n("g",{class:"trend-chart-labels-y"},e))}return n("g",t)}}};var s={name:"TrendChartCurve",props:{data:{required:!0,type:Array},className:{type:String},smooth:{default:!1,type:Boolean},stroke:{default:!0,type:Boolean},fill:{default:!1,type:Boolean},showPoints:{default:!1,type:Boolean}},computed:{points:function(){return function(t,e,n,i,a){var s=e.minX,r=e.minY,o=e.maxX,h=e.maxY;t=t.map(function(t){return"number"==typeof t?t:t.value});var l=i-.001,u=(o-s)/(a-1),d=(h-r)/(n+.001-l);return t.map(function(t,e){return{x:e*u+s,y:h-(t-l)*d+1e-5*+(e===a-1)-1e-5*+(0===e)}})}(this.data,this.$parent.boundary,this.$parent.params.maxValue,this.$parent.params.minValue,this.$parent.params.maxAmount)},paths:function(){return function(t,i,e){var n=e.maxY,a=[].concat(t),s=a.shift(),r=a[a.length-1],o=(a[0].x-s.x)/2,h="M "+s.x+","+s.y;a.forEach(function(t,e){if(i){var n=a[e-1]||s;h+=" C "+(o+n.x)+","+n.y+" "+(o+n.x)+","+t.y+" "+t.x+","+t.y}else h+=" L"+t.x+","+t.y});var l=h;return r.Y!==n&&(l+=" L"+r.x+","+n),s.Y!==n&&(l+=" L"+s.x+","+n),{linePath:h,fillPath:l+=" Z"}}(this.points,this.smooth,this.$parent.boundary)}},render:function(e){var t=[];return this.fill&&this.paths&&this.paths.fillPath&&t.push(e("path",{class:"trend-chart-fill",attrs:{d:this.paths.fillPath,fill:"rgba(0,0,0,0.15)"}})),this.stroke&&this.paths&&this.paths.linePath&&t.push(e("path",{class:"trend-chart-fill",attrs:{d:this.paths.linePath,fill:"none",stroke:"#000000"}})),this.showPoints&&t.push(e("g",{class:"trend-chart-points"},this.points.map(function(t){return e("circle",{class:"trend-chart-point",attrs:{cx:t.x,cy:t.y,r:3}})}))),e("g",{class:this.className},t)}},n={name:"TrendChart",components:{TrendChartGrid:i,TrendChartLabels:a,TrendChartCurve:s},props:{datasets:{required:!0,type:Array},grid:{default:null,type:Object},labels:{default:null,type:Object},max:{type:Number},min:{type:Number},padding:{default:"5",type:String,validator:function(t){return e(t)}}},data:function(){return{width:null,height:null,labelsOverflowObject:{top:0,right:0,bottom:0,left:0}}},computed:{paddingObject:function(){return this.padding?t(this.padding):t("0")},gridPaddingObject:function(){return this.grid&&this.grid.padding?t(this.grid.padding):t("0")},boundary:function(){var t=this,e=t.width,n=t.height,i=t.paddingObject,a=t.gridPaddingObject,s=t.labelsOverflowObject,r={minX:i.left+a.left+s.left,minY:i.top+a.top+s.top,maxX:e-i.right-a.right-s.right,maxY:n-i.bottom-a.bottom-s.bottom};return r},params:function(){var a=-1/0,s=1/0,r=0;return this.datasets.forEach(function(t){var e=t.data.map(function(t){return"number"==typeof t?t:t.value}),n=Math.max.apply(Math,e);a<n&&(a=n);var i=Math.min.apply(Math,e);i<s&&(s=i),e.length>r&&(r=e.length)}),void 0!==this.max&&this.max>a&&(a=this.max),void 0!==this.min&&this.min<s&&(s=this.min),{maxValue:a,minValue:s,maxAmount:r}}},methods:{setSize:function(){var t=this.$refs.chart.getBoundingClientRect();this.width=t.width,this.height=t.height},fitLabels:function(){var t=this.$refs.chart,e=this.$refs["chart-labels"];if(e&&(e.xLabels&&e.xLabels.length||0<e.yLabelsAmount)){var n=t.getBoundingClientRect(),i=e.$el.getBoundingClientRect(),a=n.top-i.top+this.paddingObject.top,s=i.right-n.right+this.paddingObject.right,r=i.bottom-n.bottom+this.paddingObject.bottom,o=this.paddingObject.left-i.left+n.left;this.labelsOverflowObject={top:0<a?a:0,right:0<s?s:0,bottom:0<r?r:0,left:0<o?o:0}}else this.labelsOverflowObject={top:0,right:0,bottom:0,left:0}},init:function(){var t=this;this.setSize(),this.$nextTick(function(){t.fitLabels()})},onWindowResize:function(){this.setSize()}},mounted:function(){this.init(),window.addEventListener("resize",this.onWindowResize)},destroyed:function(){window.removeEventListener("resize",this.onWindowResize)},render:function(e){var n=[];return this.grid&&n.push(e(i,{class:"trend-chart-grid",attrs:Object.assign({},this.grid)})),this.labels&&n.push(e(a,{class:"trend-chart-labels",ref:"chart-labels",attrs:Object.assign({},this.labels)})),this.datasets.map(function(t){n.push(e(s,{class:"trend-chart-curve",attrs:Object.assign({},t)}))}),e("svg",{class:"trend-chart",ref:"chart",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"}},n)},install:function(t){t.component(n.name,n)}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(n),n});
