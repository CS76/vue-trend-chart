!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self)["vue-trend-chart"]=e()}(this,function(){"use strict";function e(t){var e=t.split(" ").filter(function(t){return""!==t}).map(function(t){return parseInt(t)});return!(e.length<1||4<e.length)&&e.every(function(t){return"number"==typeof t&&0<=t})}function t(t){var e=t.split(" ").filter(function(t){return""!==t}).map(function(t){return parseInt(t)});switch(e.length){case 4:return{top:e[0],right:e[1],bottom:e[2],left:e[3]};case 3:return{top:e[0],right:e[1],bottom:e[2],left:e[1]};case 2:return{top:e[0],right:e[1],bottom:e[0],left:e[1]};default:return{top:e[0],right:e[0],bottom:e[0],left:e[0]}}}var r={name:"TrendChartGrid",props:{xAxes:{default:!1,type:Boolean},xAxesLines:{type:Number},xAxesStrokeWidth:{default:1,type:Number},xAxesStrokeColor:{default:"black",type:String},xAxesStrokeDasharray:{default:null,type:String},yAxes:{default:!1,type:Boolean},yAxesLines:{type:Number},yAxesStrokeWidth:{default:1,type:Number},yAxesStrokeColor:{default:"black",type:String},yAxesStrokeDasharray:{default:null,type:String},padding:{default:"0",type:String,validator:function(t){return e(t)}}},computed:{xLines:function(){return this.xAxesLines||this.$parent.params.maxAmount},boundary:function(){return this.$parent.boundary},gridPaddingObject:function(){return this.$parent.gridPaddingObject}},methods:{setXLineParams:function(t){var e=this,i=e.boundary,r=e.xLines,n=e.gridPaddingObject,a=e.xAxesStrokeColor,s=e.xAxesStrokeWidth,o=e.xAxesStrokeDasharray,l=(i.maxX-i.minX)/(r-1),h=i.minX+l*(t-1);return{x1:h,x2:h,y1:i.minY-n.top,y2:i.maxY+n.bottom,stroke:a,"stroke-width":s,"stroke-dasharray":o}},setYLineParams:function(t){var e=this,i=e.boundary,r=e.yAxesLines,n=e.gridPaddingObject,a=e.yAxesStrokeColor,s=e.yAxesStrokeWidth,o=e.yAxesStrokeDasharray,l=(i.maxY-i.minY)/(r-1),h=i.minY+l*(t-1);return{x1:i.minX-n.left,x2:i.maxX+n.right,y1:h,y2:h,stroke:a,"stroke-width":s,"stroke-dasharray":o}}},render:function(t){if(this.xAxes&&this.yAxes){var e=[];if(this.xAxes&&0<this.xLines){for(var i=[],r=1;r<=this.xLines;r++)i.push(t("line",{class:"trend-chart-grid-x-axis",attrs:Object.assign({},this.setXLineParams(r))}));e.push(t("g",{class:"trend-chart-grid-x"},i))}if(this.yAxes&&0<this.yAxesLines){for(var n=[],a=0;a<=this.yAxesLines;a++)n.push(t("line",{class:"trend-chart-grid-y-axis",attrs:Object.assign({},this.setYLineParams(a))}));e.push(t("g",{class:"trend-chart-grid-y"},n))}return t("g",e)}}},n={name:"TrendChartLabels",props:{xLabels:{type:Array},xLabelsPosition:{default:"bottom",type:String,validator:function(t){return-1!==["top","bottom"].indexOf(t)}},xLabelsOffset:{default:5,type:Number},yLabelsAmount:{type:Number},yLabelsPosition:{default:"left",type:String,validator:function(t){return-1!==["left","right"].indexOf(t)}},yLabelsOffset:{default:5,type:Number},yLabelsTextFormatter:{default:function(t){return t},type:Function}},computed:{boundary:function(){return this.$parent.boundary},gridPaddingObject:function(){return this.$parent.gridPaddingObject}},methods:{setXLabelsParams:function(t){var e=this,i=e.boundary,r=e.gridPaddingObject,n=e.xLabels,a=e.xLabelsPosition,s=e.xLabelsOffset,o=(i.maxX-i.minX)/(n.length-1);return{x:i.minX+o*t,y:"bottom"==a?i.maxY+r.bottom+s:i.minY-r.top-s}},setYLabelsParams:function(t){var e=this,i=e.boundary,r=e.gridPaddingObject,n=e.yLabelsAmount,a=e.yLabelsPosition,s=e.yLabelsOffset,o=(i.maxY-i.minY)/(n-1);return{x:"left"==a?i.minX-r.left-s:i.maxX+r.right+s,y:i.maxY-o*t}}},render:function(i){var r=this;if(this.xLabels&&this.xLabels.length&&this.yLabelsAmount&&0<this.yLabelsAmount){var t=[];if(this.xLabels&&this.xLabels.length&&t.push(i("g",{class:"trend-chart-labels-x"},this.xLabels.map(function(t,e){return i("text",{class:"trend-chart-label-x",attrs:Object.assign({},r.setXLabelsParams(e),{"text-anchor":"middle","dominant-baseline":"bottom"==r.xLabelsPosition?"text-before-edge":"text-after-edge"})},t)}))),this.yLabelsAmount&&0<this.yLabelsAmount){for(var e=[],n=0;n<this.yLabelsAmount;n++)e.push(i("text",{class:"trend-chart-label-y",attrs:Object.assign({},this.setYLabelsParams(n),{"text-anchor":"left"==this.yLabelsPosition?"end":"start"})},this.yLabelsTextFormatter(this.$parent.params.minValue+(this.$parent.params.maxValue-this.$parent.params.minValue)/(this.yLabelsAmount-1)*n)));t.push(i("g",{class:"trend-chart-labels-y"},e))}return i("g",t)}}};var a={name:"TrendChartCurve",props:{data:{required:!0,type:Array},className:{type:String},smooth:{default:!1,type:Boolean},stroke:{default:!0,type:Boolean},strokeWidth:{default:1,type:Number},strokeColor:{default:"black",type:String},strokeGradient:{type:Array},strokeGradientDirection:{default:"to top",type:String,validator:function(t){return-1!==["to top","to left","to bottom","to right"].indexOf(t)}},strokeDasharray:{default:"none",type:String},fill:{default:!1,type:Boolean},fillColor:{default:"black",type:String},fillGradient:{type:Array},fillGradientDirection:{default:"to top",type:String,validator:function(t){return-1!==["to top","to left","to bottom","to right"].indexOf(t)}},fillOpacity:{default:1,type:Number},showPoints:{default:!1,type:Boolean},pointsRadius:{default:2,type:Number},pointsFill:{default:"black",type:String},pointsStrokeWidth:{type:Number},pointsStrokeColor:{type:String}},computed:{points:function(){return function(t,e,i,r,n){var a=e.minX,s=e.minY,o=e.maxX,l=e.maxY;t=t.map(function(t){return"number"==typeof t?t:t.value});var h=r-.001,d=(o-a)/(n-1),u=(l-s)/(i+.001-h);return t.map(function(t,e){return{x:e*d+a,y:l-(t-h)*u+1e-5*+(e===n-1)-1e-5*+(0===e)}})}(this.data,this.$parent.boundary,this.$parent.params.maxValue,this.$parent.params.minValue,this.$parent.params.maxAmount)},paths:function(){return function(t,r,e){var i=e.maxY,n=[].concat(t),a=n.shift(),s=n[n.length-1],o=(n[0].x-a.x)/2,l="M "+a.x+","+a.y;n.forEach(function(t,e){if(r){var i=n[e-1]||a;l+=" C "+(o+i.x)+","+i.y+" "+(o+i.x)+","+t.y+" "+t.x+","+t.y}else l+=" L"+t.x+","+t.y});var h=l;return s.Y!==i&&(h+=" L"+s.x+","+i),a.Y!==i&&(h+=" L"+a.x+","+i),{linePath:l,fillPath:h+=" Z"}}(this.points,this.smooth,this.$parent.boundary)},strokeGradientId:function(){return"vtsg"+this._uid},fillGradientId:function(){return"vtfg"+this._uid}},methods:{getGradientDirection:function(t){switch(t){case"to left":return{x1:0,y1:0,x2:1,y2:0};case"to bottom":return{x1:0,y1:0,x2:0,y2:1};case"to right":return{x1:1,y1:0,x2:0,y2:0};default:return{x1:0,y1:1,x2:0,y2:0}}}},render:function(i){var r=this,t=[];if(this.fill&&this.paths&&this.paths.fillPath&&t.push(i("path",{class:"trend-chart-fill",attrs:{d:this.paths.fillPath,fill:this.fillGradient?"url(#"+this.fillGradientId+")":this.fillColor,opacity:this.fillOpacity}})),this.stroke&&this.paths&&this.paths.linePath&&t.push(i("path",{class:"trend-chart-fill",attrs:{d:this.paths.linePath,fill:"none",stroke:this.strokeGradient?"url(#"+this.strokeGradientId+")":this.strokeColor,"stroke-width":this.strokeWidth,"stroke-dasharray":this.strokeDasharray}})),this.showPoints&&t.push(i("g",{class:"trend-chart-points"},this.points.map(function(t){return i("circle",{class:"trend-chart-point",attrs:{cx:t.x,cy:t.y,r:r.pointsRadius,fill:r.pointsFill,stroke:r.pointsStrokeColor,"stroke-width":r.pointsStrokeWidth}})}))),this.strokeGradient||this.fillGradient){var e=[];this.strokeGradient&&e.push(i("linearGradient",{attrs:Object.assign({},{id:this.strokeGradientId},this.getGradientDirection(this.strokeGradientDirection))},this.strokeGradient.map(function(t,e){return i("stop",{attrs:{offset:e/r.strokeGradient.length,"stop-color":t}})}))),this.fillGradient&&e.push(i("linearGradient",{attrs:Object.assign({},{id:this.fillGradientId},this.getGradientDirection(this.fillGradientDirection))},this.fillGradient.map(function(t,e){return i("stop",{attrs:{offset:e/r.fillGradient.length,"stop-color":t}})}))),t.push(i("defs",e))}return i("g",{class:this.className},t)}},i={name:"TrendChart",components:{TrendChartGrid:r,TrendChartLabels:n,TrendChartCurve:a},props:{datasets:{required:!0,type:Array},grid:{default:null,type:Object},labels:{default:null,type:Object},max:{type:Number},min:{type:Number},padding:{default:"5",type:String,validator:function(t){return e(t)}}},data:function(){return{width:null,height:null,labelsOverflowObject:{top:0,right:0,bottom:0,left:0}}},computed:{paddingObject:function(){return this.padding?t(this.padding):t("0")},gridPaddingObject:function(){return this.grid&&this.grid.padding?t(this.grid.padding):t("0")},boundary:function(){var t=this,e=t.width,i=t.height,r=t.paddingObject,n=t.gridPaddingObject,a=t.labelsOverflowObject,s={minX:r.left+n.left+a.left,minY:r.top+n.top+a.top,maxX:e-r.right-n.right-a.right,maxY:i-r.bottom-n.bottom-a.bottom};return s},params:function(){var n=-1/0,a=1/0,s=0;return this.datasets.forEach(function(t){var e=t.data.map(function(t){return"number"==typeof t?t:t.value}),i=Math.max.apply(Math,e);n<i&&(n=i);var r=Math.min.apply(Math,e);r<a&&(a=r),e.length>s&&(s=e.length)}),void 0!==this.max&&this.max>n&&(n=this.max),void 0!==this.min&&this.min<a&&(a=this.min),{maxValue:n,minValue:a,maxAmount:s}}},methods:{setSize:function(){var t=this.$refs.chart.getBoundingClientRect();this.width=t.width,this.height=t.height},fitLabels:function(){var t=this.$refs.chart,e=this.$refs["chart-labels"];if(e&&(e.xLabels&&e.xLabels.length||0<e.yLabelsAmount)){var i=t.getBoundingClientRect(),r=e.$el.getBoundingClientRect(),n=i.top-r.top+this.paddingObject.top,a=r.right-i.right+this.paddingObject.right,s=r.bottom-i.bottom+this.paddingObject.bottom,o=this.paddingObject.left-r.left+i.left;this.labelsOverflowObject={top:0<n?n:0,right:0<a?a:0,bottom:0<s?s:0,left:0<o?o:0}}else this.labelsOverflowObject={top:0,right:0,bottom:0,left:0}},init:function(){var t=this;this.setSize(),this.$nextTick(function(){t.fitLabels()})},onWindowResize:function(){this.setSize()}},mounted:function(){this.init(),window.addEventListener("resize",this.onWindowResize)},destroyed:function(){window.removeEventListener("resize",this.onWindowResize)},render:function(e){var i=[];return this.grid&&i.push(e(r,{class:"trend-chart-grid",attrs:Object.assign({},this.grid)})),this.labels&&i.push(e(n,{class:"trend-chart-labels",ref:"chart-labels",attrs:Object.assign({},this.labels)})),this.datasets.map(function(t){i.push(e(a,{class:"trend-chart-curve",attrs:Object.assign({},t)}))}),e("svg",{class:"trend-chart",ref:"chart",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%"}},i)},install:function(t){t.component(i.name,i)}};return"undefined"!=typeof window&&window.Vue&&window.Vue.use(i),i});
